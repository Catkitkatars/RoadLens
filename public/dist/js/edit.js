import{L as l}from"./index.js";function s(a,e,n){const r=a.lat*Math.PI/180,h=a.lng*Math.PI/180,v=n*Math.PI/180,L=Math.asin(Math.sin(r)*Math.cos(e/6371e3)+Math.cos(r)*Math.sin(e/6371e3)*Math.cos(v)),f=h+Math.atan2(Math.sin(v)*Math.sin(e/6371e3)*Math.cos(r),Math.cos(e/6371e3)-Math.sin(r)*Math.sin(L));return l.latLng(L*180/Math.PI,f*180/Math.PI)}function g(a){return a-=180,a<-180?a+=360:a>=180&&(a-=360),a}var d=[6.83442,52.43369],m=[6.83342,52.43469];let u=l.map("map",{center:[d[1],d[0]],zoom:17});l.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="#">RoadLens</a>'}).addTo(u);var M={type:"Feature",properties:{angle:20},geometry:{type:"GeometryCollection",geometries:[{type:"Point",coordinates:d},{type:"Point",coordinates:m}]}},w={draggable:!0,angleMarker:!0,control:!1,cameraIcon:l.icon({iconUrl:"../images/main-pin.png",iconSize:[38,38],iconAnchor:[19,35]}),targetIcon:l.icon({iconUrl:"../images/marker.svg",iconSize:[32,32],iconAnchor:[16,16]}),angleIcon:l.icon({iconUrl:"../images/marker.svg",iconSize:[32,32],iconAnchor:[16,16]}),outlineStyle:{color:"#03e9f4",opacity:.3,weight:2,dashArray:"1, 1",lineCap:"round",lineJoin:"round"},fillStyle:{weight:0,fillOpacity:.3,fillColor:"#032b2d"}};let t=l.geotagPhoto.camera(M,w).addTo(u),c=t.getFieldOfView(),p=t.getCameraLatLng();latitude.value=p.lat.toFixed(6);longitude.value=p.lng.toFixed(6);direction.value=Math.round(c.properties.bearing);angle.value=Math.round(c.properties.angle);distance.value=Math.round(c.properties.distance);let i=!1;latitude.addEventListener("change",function(a){i=!0;let e=l.latLng(latitude.value,longitude.value);t.setCameraLatLng(e);let n=distance.value,o=g(direction.value),r=s(e,n,o);t.setTargetLatLng(r),i=!1});longitude.addEventListener("change",function(a){i=!0;let e=l.latLng(latitude.value,longitude.value);t.setCameraLatLng(e);let n=distance.value,o=g(direction.value),r=s(e,n,o);t.setTargetLatLng(r),i=!1});latitude.addEventListener("input",function(){u.setView([latitude.value,longitude.value],17)});longitude.addEventListener("input",function(){u.setView([latitude.value,longitude.value],17)});angle.addEventListener("input",function(a){i=!0;let e=t.getFieldOfView();e.properties.distance=Math.round(Number(distance.value)),this.value>180||this.value<5?t.setAngle(e.properties.angle):t.setAngle(Number(this.value)),console.log("ширина луча"),i=!1});distance.addEventListener("input",function(a){i=!0;let e=distance.value,n=g(direction.value),o=s(t.getCameraLatLng(),e,n);t.setTargetLatLng(o),console.log("длина луча"),i=!1});direction.addEventListener("input",function(a){i=!0;let e=distance.value,n=g(direction.value),o=s(t.getCameraLatLng(),e,n);t.setTargetLatLng(o),console.log("длина луча"),i=!1});t.on("change",function(a){if(!i){let e=t.getFieldOfView(),n=t.getCameraLatLng();latitude.value=n.lat.toFixed(6),longitude.value=n.lng.toFixed(6),direction.value=Math.round(e.properties.bearing),angle.value=Math.round(e.properties.angle),distance.value=Math.round(e.properties.distance)}});
